<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
    
    <entry>
      <title><![CDATA[在Unity中调用Android原生Activity的方法]]></title>
      <url>http://blog.acring.me/2017/03/18/%E5%9C%A8Unity%E4%B8%AD%E8%B0%83%E7%94%A8Android%E5%8E%9F%E7%94%9FActivity%E7%9A%84%E6%96%B9%E6%B3%95/</url>
      <content type="html"><![CDATA[<h2 id="在Android-studio-中创建新工程"><a href="#在Android-studio-中创建新工程" class="headerlink" title="在Android studio 中创建新工程"></a>在Android studio 中创建新工程</h2><h3 id="创建新工程"><a href="#创建新工程" class="headerlink" title="创建新工程"></a>创建新工程</h3><ul>
<li>设定的Mininum SDK不要太高，我设定的API 21</li>
</ul>
<h3 id="在工程中引入Unity的接口包"><a href="#在工程中引入Unity的接口包" class="headerlink" title="在工程中引入Unity的接口包"></a>在工程中引入Unity的接口包</h3><blockquote>
<p>接口包的位置可能随版本有所不同我用的是 <em>Editor\Data\PlaybackEngines\AndroidPlayer\Variations\mono\Release\Classes</em></p>
</blockquote>
<ul>
<li>把目录下的classes.jar放入新建的工程的app\libs下</li>
</ul>
<blockquote>
<p>在项目管理器调成project模式比较好找位置</p>
</blockquote>
<p>TODO:加个图</p>
<ul>
<li>右键classes包Add as Library,<strong>把包加入环境中</strong></li>
</ul>
<h3 id="修改MainActivity为UnityPlayerActivity"><a href="#修改MainActivity为UnityPlayerActivity" class="headerlink" title="修改MainActivity为UnityPlayerActivity"></a>修改MainActivity为UnityPlayerActivity</h3><p><strong>接下来我们要把MainActivity继承于UnityPlayerActivity，让他在Unity项目打开的时候就启动并在这个类中提供打开新的有界面的Activity的接口</strong></p>
<ul>
<li>改变MainActivity的继承并删除setContentView方法(<em>因为我们一开始不需要界面，只需要它能启动,不删掉会直接出现Android界面就没有我们想要的效果了</em>)</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainActivity</span> <span class="keyword">extends</span> <span class="title">UnityPlayerActivity</span></span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle savedInstanceState)</span> </span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(savedInstanceState);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h3 id="创建新界面的Activity和layout并在MainActivity中写出相应的调用函数"><a href="#创建新界面的Activity和layout并在MainActivity中写出相应的调用函数" class="headerlink" title="创建新界面的Activity和layout并在MainActivity中写出相应的调用函数"></a>创建新界面的Activity和layout并在MainActivity中写出相应的调用函数</h3><ul>
<li>新创建一个java类作为新的Activity并创建相应的layout</li>
</ul>
<p><strong>KouyuActivity.java</strong></p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">package</span> me.acring.mainkouyu;</div><div class="line"></div><div class="line"><span class="keyword">import</span> android.app.Activity;</div><div class="line"><span class="keyword">import</span> android.os.Bundle;</div><div class="line"></div><div class="line"><span class="comment">/**</span></div><div class="line"> * Created by Acring on 2017/3/17.</div><div class="line"> * 口语练习</div><div class="line"> */</div><div class="line"></div><div class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">KouyuActivity</span> <span class="keyword">extends</span> <span class="title">Activity</span></span>&#123;</div><div class="line"></div><div class="line">    <span class="meta">@Override</span></div><div class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">onCreate</span><span class="params">(Bundle saveIntentState)</span></span>&#123;</div><div class="line">        <span class="keyword">super</span>.onCreate(saveIntentState);</div><div class="line">        setContentView(R.layout.activity_kouyu);</div><div class="line">    &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p><strong>activity_kouyu.xml</strong></p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line">&lt;?xml version="1.0" encoding="utf-8"?&gt;</div><div class="line"><span class="tag">&lt;<span class="name">LinearLayout</span> <span class="attr">xmlns:android</span>=<span class="string">"http://schemas.android.com/apk/res/android"</span></span></div><div class="line">    <span class="attr">android:orientation</span>=<span class="string">"vertical"</span> <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">    <span class="attr">android:layout_height</span>=<span class="string">"match_parent"</span>&gt;</div><div class="line">    <span class="tag">&lt;<span class="name">TextView</span></span></div><div class="line">        <span class="attr">android:layout_width</span>=<span class="string">"match_parent"</span></div><div class="line">        <span class="attr">android:layout_height</span>=<span class="string">"wrap_content"</span></div><div class="line">        <span class="attr">android:text</span>=<span class="string">"口语练习"</span>/&gt;</div><div class="line"><span class="tag">&lt;/<span class="name">LinearLayout</span>&gt;</span></div></pre></td></tr></table></figure>
<ul>
<li>在MainActivity中添加函数</li>
</ul>
<figure class="highlight java"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">startMyActivity</span><span class="params">()</span></span>&#123;</div><div class="line">        Intent intent = <span class="keyword">new</span> Intent(MainActivity.<span class="keyword">this</span>, KouyuActivity.class);</div><div class="line">        startActivity(intent);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<h3 id="配置AndroidManifest-xml"><a href="#配置AndroidManifest-xml" class="headerlink" title="配置AndroidManifest.xml"></a>配置AndroidManifest.xml</h3><ul>
<li>配置Activity</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">activity</span></span></div><div class="line">            <span class="attr">android:name</span>=<span class="string">".KouyuActivity"</span></div><div class="line">            <span class="attr">android:theme</span>=<span class="string">"@android:style/Theme.NoTitleBar.Fullscreen"</span></div><div class="line">            &gt;</div><div class="line">        <span class="tag">&lt;/<span class="name">activity</span>&gt;</span></div></pre></td></tr></table></figure>
<ul>
<li>配置UnityActivity</li>
<li>添加 <code>&lt;meta-data android:name=&quot;unityplayer.UnityActivity&quot; android:value=&quot;true&quot; /&gt;</code></li>
<li>注意添加位置</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">activity</span> <span class="attr">android:name</span>=<span class="string">".MainActivity"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">meta-data</span> <span class="attr">android:name</span>=<span class="string">"unityplayer.UnityActivity"</span> <span class="attr">android:value</span>=<span class="string">"true"</span> /&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">intent-filter</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">action</span> <span class="attr">android:name</span>=<span class="string">"android.intent.action.MAIN"</span> /&gt;</span></div><div class="line"></div><div class="line">                <span class="tag">&lt;<span class="name">category</span> <span class="attr">android:name</span>=<span class="string">"android.intent.category.LAUNCHER"</span> /&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">intent-filter</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">activity</span>&gt;</span></div></pre></td></tr></table></figure>
<h3 id="修改style-xml的配置"><a href="#修改style-xml的配置" class="headerlink" title="修改style.xml的配置"></a>修改style.xml的配置</h3><ul>
<li>打开style.xml</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">"AppTheme"</span> <span class="attr">parent</span>=<span class="string">"Theme.AppCompat.Light.DarkActionBar"</span>&gt;</span><span class="xml"></span></div><div class="line">    <span class="comment">&lt;!-- Customize your theme here. --&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"colorPrimary"</span>&gt;</span>@color/colorPrimary<span class="tag">&lt;/<span class="name">item</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"colorPrimaryDark"</span>&gt;</span>@color/colorPrimaryDark<span class="tag">&lt;/<span class="name">item</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">item</span> <span class="attr">name</span>=<span class="string">"colorAccent"</span>&gt;</span>@color/colorAccent<span class="tag">&lt;/<span class="name">item</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></div></pre></td></tr></table></figure>
<ul>
<li>以上全部删去修改为</li>
</ul>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">style</span> <span class="attr">name</span>=<span class="string">"AppTheme"</span> <span class="attr">parent</span>=<span class="string">"android:Theme.Light"</span>&gt;</span><span class="undefined"></span></div><div class="line"><span class="tag">&lt;/<span class="name">style</span>&gt;</span></div></pre></td></tr></table></figure>
<p>目的是去掉对V7包的引用，否则Unity在Build的时候会报错</p>
<ul>
<li><strong>上述步骤会使layout显示以下警告，目前不知道怎么解决，但是对程序运行似乎没有影响</strong></li>
</ul>
<blockquote>
<p>​    <strong>Missing styles. Is the correct theme chosen for this layout?</strong><br>​    Use the Theme combo box above the layout to choose a different layout, or fix<br>​    the theme style references.</p>
</blockquote>
<h3 id="修改build-gradle文件"><a href="#修改build-gradle文件" class="headerlink" title="修改build.gradle文件"></a>修改build.gradle文件</h3><ul>
<li>在<strong>build.gradle</strong>文件(<strong>Module:app</strong>)顶部类似线面的代码中:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">apply plugin: &apos;com.android.application&apos;</div><div class="line"></div><div class="line">android &#123;</div><div class="line">    compileSdkVersion 25</div><div class="line">    buildToolsVersion &quot;25.0.2&quot;</div><div class="line">    defaultConfig &#123;</div><div class="line">        applicationId &quot;me.acring.mainkouyu&quot;</div></pre></td></tr></table></figure>
<ul>
<li>将<code>apply plugin: &#39;com.android.application&#39;</code> 修改为<code>apply plugin: &#39;com.android.library&#39;</code></li>
<li>注释掉<code>applicationId &quot;me.acring.mainkouyu&quot;</code></li>
<li>删除:</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">compile &apos;com.android.support:appcompat-v7:25.0.0&apos;</div><div class="line">testCompile &apos;junit:junit:4.12&apos;</div></pre></td></tr></table></figure>
<p><strong>做完之后程序不能单独在AS运行并且Junit程序会报错，不过都是正常的</strong></p>
<h3 id="Build-APK并取出关键文件"><a href="#Build-APK并取出关键文件" class="headerlink" title="Build APK并取出关键文件"></a>Build APK并取出关键文件</h3><ul>
<li>最后一步 <strong>Sync Now</strong> 并 <strong>Build APK</strong></li>
<li>可能提示 <code>Error:(6, 30) 错误: 程序包android.support.v7.app不存在</code></li>
<li>把 <code>import android.support.v7.app.AppCompatActivity;</code>注释掉就行了</li>
<li>取出<code>\app\build\outputs\aarapp-debug.aar</code>文件和<code>\app\src\main\AndroidManifest.xml</code>文件(放到一个临时位置)</li>
<li>用压缩软件打开aarapp-debug.aar文件并删除掉目录下的 \libs\classes.jar 文件。（避免重复引用）</li>
</ul>
<p><strong>安卓部分到此结束</strong></p>
<hr>
<h2 id="Unity工程的配置和调用"><a href="#Unity工程的配置和调用" class="headerlink" title="Unity工程的配置和调用"></a>Unity工程的配置和调用</h2><hr>
<h3 id="创建目录并引用文件"><a href="#创建目录并引用文件" class="headerlink" title="创建目录并引用文件"></a>创建目录并引用文件</h3><ul>
<li>新建Unity项目，在Assets目录下新建Plugins\Android\目录</li>
<li>把刚刚取出的两个文件放到该目录下</li>
</ul>
<h3 id="创建按钮并配置脚本"><a href="#创建按钮并配置脚本" class="headerlink" title="创建按钮并配置脚本"></a>创建按钮并配置脚本</h3><ul>
<li>新建一个C#脚本，添加如下函数</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">public void startMyActivity()</div><div class="line">    &#123;</div><div class="line">        //AndroidJavaClass：通过指定类名可以构造出一个类</div><div class="line">        AndroidJavaClass jc = new AndroidJavaClass(&quot;com.unity3d.player.UnityPlayer&quot;);</div><div class="line"></div><div class="line">        // UnityPlayer这个类可以获取当前的Activity</div><div class="line">        // currentActivity字符串对应源码中UnityPlayer类下 的 Activity 变量名。</div><div class="line">        AndroidJavaObject jo = jc.GetStatic&lt;AndroidJavaObject&gt;(&quot;currentActivity&quot;);</div><div class="line"></div><div class="line">        // 在对象上调用一个Java方法</div><div class="line">        jo.Call(&quot;startMyActivity&quot;);</div><div class="line">    &#125;</div></pre></td></tr></table></figure>
<ul>
<li>把脚本配置到按钮上并绑定OnClick(具体方法应该都知道)</li>
</ul>
<h3 id="切换平台并配置必要参数"><a href="#切换平台并配置必要参数" class="headerlink" title="切换平台并配置必要参数"></a>切换平台并配置必要参数</h3><ul>
<li>打开Build Settings切换到Android平台，打开Player Settings修改Bundle Indentifier为Android工程中AndroidManifest.xml下package的名称,修改Minimum API Level为Android工程对应的API级别</li>
</ul>
]]></content>
      
        
        <tags>
            
            <tag> Unity3D </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[First]]></title>
      <url>http://blog.acring.me/2017/03/15/First/</url>
      <content type="html"><![CDATA[<h1 id="Acring的第一个小站成立啦"><a href="#Acring的第一个小站成立啦" class="headerlink" title="Acring的第一个小站成立啦"></a>Acring的第一个小站成立啦</h1><a id="more"></a>
<h2 id="一"><a href="#一" class="headerlink" title="一"></a>一</h2><hr>
<p>​    从大学开始一脸懵逼的接触计算机到现在已经在计算机领域摸索了两年，终于想着要给自己建一个属于自己的小窝，毕竟一个做计算机的一直没有一个属于自己的域名，博客还是很说不过去的。</p>
<p>​    最开始的想法是<strong>小熊师兄Airing</strong>给我的，因为我在朋友的推荐下蹭了他在软件工程二专的代理课，大概知道了怎么建站，然后也看了小熊师兄的<a href="https://blog.ursb.me" target="_blank" rel="external">个人博客</a>，感觉他的博客真的相当的漂亮，上面有很多自己的<strong>学习经历</strong>和<strong>想法</strong>，还有自己写的书，自己做的项目，专业的和业余的，当时就觉得师兄是我的<strong>偶像</strong>!!</p>
<p>​    当然，对我来说，<strong>偶像不是崇拜的对象，而是未来的目标</strong>: )。所以呢，我想着自己会有这么一天，而这一天也终有到了，我有了自己的域名==&gt;acring.me，博客域名==&gt;<a href="http://blog.acring.me">blog.acring.me</a>，虽然还很简陋但是我会慢慢把这装扮的<em>简洁而优雅</em>的，这是我一贯的 风格，最后欢迎大家来我这玩。</p>
<h2 id="二"><a href="#二" class="headerlink" title="二"></a>二</h2><hr>
<p>​    为什么要建自己的博客，当然是为了<strong>有个地方分享自己想要分享的东西</strong>，我之前没有记录的习惯，虽然做了很多有趣的小东西但一直没有想过要把这些记录下来，一是觉得自己现在玩的东西都太<em>幼稚</em>了，太<em>简单</em>了，没必要记录，更没必要分享给别人，毕竟一堆人比我更优秀，怕是有班门弄斧之嫌.</p>
<p>​    但是随着自己对计算机更多的喜爱和更多的了解，接触的东西越来越多，如果没有一个地方把这些记录下来，我觉得我即使做了过不久也就忘了，最典型的就是我大一做的抢课脚本，现在已经维护不了了，怕是之后要重写了。我的记忆力也不是相当出色的，我能熟练运用一门编程语言的唯一优势就是我会经常去使用它，而一旦不使用，比如<em>HTML</em>和<em>CSS</em>，我就忘了该怎么开始了，所以记录的习惯变得越来越重要。</p>
<p>​    同时呢，我觉得自己已经能做出一些一般人想不到或做不出的东西了，这让我越来越希望能把自己的成果分享出去，或是希望更多人得到启发或是希望得到内心的虚荣心，反正结果便是这样了。</p>
<h2 id="三"><a href="#三" class="headerlink" title="三"></a>三</h2><hr>
<p>​    我依然是一个刚刚走出新手村的萌新，可以叫我<em>AC</em>，也可以叫我<em>手环</em>,或者<em>Acring</em>,这都不重要，<strong>希望你能从我这有所收获，这个比较重要~</strong></p>
<p><img src="http://omudx2uw8.bkt.clouddn.com/ring0.jpg" alt=""></p>
]]></content>
      
        
        <tags>
            
            <tag> 随笔 </tag>
            
        </tags>
        
    </entry>
    
  
  
</search>
